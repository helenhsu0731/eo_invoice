<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿«å¸¶ç§‘æŠ€ - è²»ç”¨è«‹æ¬¾ç³»çµ±</title>
    <style>
        :root {
            --border-color: #000;
        }

        body {
            font-family: "Microsoft JhengHei", sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* æ“ä½œä»‹é¢ */
        .ui-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            width: 100%;
            max-width: 900px;
            border-top: 4px solid #007bff;
        }

        .btn-group {
            margin-top: 15px;
            display: flex;
            gap: 10px;
        }

        button {
            padding: 8px 20px;
            cursor: pointer;
            border: none;
            border-radius: 4px;
            font-weight: bold;
        }

        .btn-add { background-color: #28a745; color: white; }
        .btn-print { background-color: #007bff; color: white; }
        .btn-delete { background-color: #f44336; color: white; padding: 4px 8px; font-size: 12px; }

        /* è«‹æ¬¾å–®ä¸»é«” */
        .print-area {
            background: white;
            width: 210mm;
            padding: 12mm;
            box-sizing: border-box;
            box-shadow: 0 0 10px rgba(0,0,0,0.05);
        }

        .form-header {
            text-align: center;
            margin-bottom: 10px;
        }

        .company-name {
            font-size: 26px;
            font-weight: bold;
            letter-spacing: 1px;
        }

        .form-title {
            font-size: 18px;
            margin-top: 5px;
            line-height: 1.4;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }

        td {
            border: 1px solid var(--border-color);
            padding: 6px 8px;
            vertical-align: middle;
            word-wrap: break-word;
        }

        /* åŸºæœ¬è³‡è¨Šåˆ— (ä¸æ›è¡Œ) */
        .info-label {
            width: 130px;
            white-space: nowrap;
        }

        .info-input-cell {
            width: auto;
        }

        .date-cell {
            width: 45%;
            text-align: right;
            font-size: 15px;
            white-space: nowrap;
        }

        .date-unit {
            margin-left: 12px;
        }

        /* æ¨™é¡Œåˆ—èˆ‡åˆè¨ˆåˆ—ï¼šé«˜åº¦ç¸®å°ä»¥çªé¡¯ */
        .header-row td, .total-row td {
            height: 32px; /* è¼ƒå°çš„é«˜åº¦ */
            font-weight: bold;
            text-align: center;
            background-color: #fafafa; /* è¼•å¾®åº•è‰²è¼”åŠ©è¦–è¦º(åˆ—å°æ™‚å¯ä¸é¡¯) */
        }

        /* è¼¸å…¥å…§å®¹åˆ—ï¼šç¶­æŒé©åº¦ç©ºé–“ä¸¦è‡ªé©æ‡‰ */
        .data-row td {
            height: auto;
            min-height: 60px; /* çµ¦äºˆåŸºæœ¬çš„é«˜åº¦æ„Ÿ */
            vertical-align: top;
            padding: 10px 8px;
        }

        .editable-area {
            width: 100%;
            min-height: 40px;
            outline: none;
            text-align: left;
            white-space: pre-wrap;
            font-size: 16px;
            line-height: 1.5;
        }

        /* è¼¸å…¥æ¡†æ¨£å¼ */
        input[type="text"], input[type="number"] {
            width: 95%;
            border: none;
            font-size: 16px;
            outline: none;
            background: transparent;
            font-family: inherit;
        }

        .amount-input {
            text-align: right;
            width: 100%;
            margin-top: 5px;
        }

        /* åˆªé™¤æŒ‰éˆ•å®šä½ */
        .action-wrapper {
            position: relative;
        }

        .btn-delete-pos {
            position: absolute;
            right: -60px;
            top: 10px;
        }

        @media print {
            body { background: white; padding: 0; }
            .ui-container, .btn-delete-pos { display: none !important; }
            .print-area { box-shadow: none; width: 100%; padding: 0; }
            .header-row td, .total-row td { background-color: transparent !important; }
            input::placeholder { color: transparent; }
        }
    </style>
</head>
<body>

    <div class="ui-container">
        <h2>å¿«å¸¶ç§‘æŠ€è²»ç”¨è«‹æ¬¾ç³»çµ±</h2>
        <p>ğŸ’¡è«‹åœ¨ä¸‹æ–¹è¡¨æ ¼ç›´æ¥å¡«å¯«å…§å®¹ï¼Œç³»çµ±æœƒ<b>è‡ªå‹•åŠ ç¸½é‡‘é¡</b>ã€‚å¡«å¯«å®Œç•¢å¾Œå³å¯é»æ“Šã€Œåˆ—å°è¡¨å–®ã€ã€‚ </p>
        <div class="btn-group">
            <button class="btn-add" onclick="addRow()">ï¼‹ æ–°å¢ä¸€ç­†é …ç›®</button>
            <button class="btn-print" onclick="window.print()">ğŸ–¨ï¸ ç¢ºèªä¸¦åˆ—å°å–®æ“š</button>
        </div>
    </div>

    <div class="print-area">
        <div class="form-header">
            <div class="company-name">å¿«å¸¶ç§‘æŠ€æœ‰é™å…¬å¸</div>
            <div class="form-title">å“¡å·¥è²»ç”¨è«‹æ¬¾å–®<br>Employee Expense Request Form</div>
        </div>

        <table>
            <!-- è³‡è¨Šèˆ‡æ—¥æœŸ -->
            <tr>
                <td class="info-label">éƒ¨é–€ Department</td>
                <td class="info-input-cell"><input type="text" placeholder="è¼¸å…¥éƒ¨é–€åç¨±"></td>
                <td rowspan="2" class="date-cell">
                    <span class="date-unit"><span id="y"></span> å¹´ Year</span>
                    <span class="date-unit"><span id="m"></span> æœˆ Month</span>
                    <span class="date-unit"><span id="d"></span> æ—¥ Day</span>
                </td>
            </tr>
            <tr>
                <td class="info-label">ç”³è«‹äºº Applicant</td>
                <td class="info-input-cell"><input type="text" placeholder="è¼¸å…¥å§“å"></td>
            </tr>

            <!-- æ¨™é¡Œåˆ— (ç¸®å°é«˜åº¦) -->
            <tr class="header-row">
                <td colspan="2" style="width: 70%;">æ‘˜è¦ Abstract / æ†‘è­‰é»è²¼ Voucher Paste</td>
                <td style="width: 30%;">é‡‘é¡ Amount</td>
            </tr>

            <!-- é …ç›®è¼¸å…¥å€ (è‡ªé©æ‡‰é«˜åº¦) -->
            <tbody id="items-body">
                <tr class="data-row">
                    <td colspan="2">
                        <div class="editable-area" contenteditable="true" placeholder="è«‹è¼¸å…¥æ‘˜è¦..."></div>
                    </td>
                    <td class="action-wrapper">
                        <input type="number" class="amount-input" value="0" oninput="calcTotal()">
                        <div class="btn-delete-pos">
                            <button class="btn-delete" onclick="removeRow(this)">åˆªé™¤</button>
                        </div>
                    </td>
                </tr>
            </tbody>

            <!-- åˆè¨ˆåˆ— (ç¸®å°é«˜åº¦) -->
            <tr class="total-row">
                <td colspan="2">åˆè¨ˆ Total</td>
                <td id="total-display" style="text-align: right; padding-right: 15px;">0</td>
            </tr>

            <!-- ç°½ç½²å€ -->
            <tr style="height: 70px;">
                <td colspan="2" style="vertical-align: top; padding-top: 10px;">ä¸»ç®¡ Managerï¼š</td>
                <td style="vertical-align: top; padding-top: 10px;">ç”³è«‹äºº Applicantï¼š</td>
            </tr>
        </table>
    </div>

    <script>
        // è¨­å®šä»Šæ—¥æ—¥æœŸ
        const date = new Date();
        document.getElementById('y').innerText = date.getFullYear();
        document.getElementById('m').innerText = date.getMonth() + 1;
        document.getElementById('d').innerText = date.getDate();

        // æ–°å¢è¡Œ
        function addRow() {
            const tbody = document.getElementById('items-body');
            const tr = document.createElement('tr');
            tr.className = 'data-row';
            tr.innerHTML = `
                <td colspan="2">
                    <div class="editable-area" contenteditable="true"></div>
                </td>
                <td class="action-wrapper">
                    <input type="number" class="amount-input" value="0" oninput="calcTotal()">
                    <div class="btn-delete-pos">
                        <button class="btn-delete" onclick="removeRow(this)">åˆªé™¤</button>
                    </div>
                </td>
            `;
            tbody.appendChild(tr);
        }

        // åˆªé™¤è¡Œ
        function removeRow(btn) {
            const rows = document.querySelectorAll('.data-row');
            if (rows.length > 1) {
                btn.closest('tr').remove();
                calcTotal();
            } else {
                alert("å¿…é ˆä¿ç•™è‡³å°‘ä¸€é …å…§å®¹ã€‚");
            }
        }

        // è¨ˆç®—ç¸½è¨ˆ
        function calcTotal() {
            const inputs = document.querySelectorAll('.amount-input');
            let sum = 0;
            inputs.forEach(input => {
                sum += parseFloat(input.value) || 0;
            });
            document.getElementById('total-display').innerText = sum.toLocaleString();
        }
    </script>
</body>
</html>
